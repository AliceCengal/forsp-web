import{E as y,F as he,c as Be,S as ue,T as ot,C as Pi,a as Wi,b as p,I as hn,g as un,d as Mt,i as Ne,e as dn,A as Qe,f as M,m as re,s as de,N as ft,h as mn,j as ht,D as pn,k as ee,V as Lt,l as k,n as W,o as Bt,p as J,q as Se,r as w,P as wt,t as Dt,u as ke,R as Fi,v as Ni,w as _e,x as $i,y as gn,z as ut,M as Ui,B as Hi,G as qi,H as zi,W as Vi,J as Ki,K as ji,L as Gi,O as yn,Q as Ji,U as xn,X as Qi,Y as _i,Z as Et,_ as Yi,$ as Xi,a0 as Zi,a1 as eo,a2 as bn,a3 as to,a4 as m,a5 as no,a6 as P,a7 as io,a8 as oo}from"./index-BLbSPDRZ.js";import{av as rl,a9 as sl,aa as ll,ab as al,aw as cl,ac as fl,ax as hl,ad as ul,ay as dl,ae as ml,az as pl,aA as gl,af as yl,ag as xl,ah as bl,aB as Sl,ai as kl,aj as Cl,ak as vl,al as Al,am as Ml,an as Ll,ao as Bl,ap as wl,aq as Dl,ar as El,as as Tl,at as Il,au as Ol}from"./index-BLbSPDRZ.js";function ro(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}const so=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),i=It(t.state,n.from);return i.line?lo(t):i.block?co(t):!1};function Tt(t,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let o=t(e,n);return o?(i(n.update(o)),!0):!1}}const lo=Tt(uo,0),ao=Tt(Sn,0),co=Tt((t,e)=>Sn(t,e,ho(e)),0);function It(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const xe=50;function fo(t,{open:e,close:n},i,o){let r=t.sliceDoc(i-xe,i),s=t.sliceDoc(o,o+xe),l=/\s*$/.exec(r)[0].length,a=/^\s*/.exec(s)[0].length,c=r.length-l;if(r.slice(c-e.length,c)==e&&s.slice(a,a+n.length)==n)return{open:{pos:i-l,margin:l&&1},close:{pos:o+a,margin:a&&1}};let f,h;o-i<=2*xe?f=h=t.sliceDoc(i,o):(f=t.sliceDoc(i,i+xe),h=t.sliceDoc(o-xe,o));let u=/^\s*/.exec(f)[0].length,d=/\s*$/.exec(h)[0].length,g=h.length-d-n.length;return f.slice(u,u+e.length)==e&&h.slice(g,g+n.length)==n?{open:{pos:i+u+e.length,margin:/\s/.test(f.charAt(u+e.length))?1:0},close:{pos:o-d-n.length,margin:/\s/.test(h.charAt(g-1))?1:0}}:null}function ho(t){let e=[];for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),o=n.to<=i.to?i:t.doc.lineAt(n.to),r=e.length-1;r>=0&&e[r].to>i.from?e[r].to=o.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:o.to})}return e}function Sn(t,e,n=e.selection.ranges){let i=n.map(r=>It(e,r.from).block);if(!i.every(r=>r))return null;let o=n.map((r,s)=>fo(e,i[s],r.from,r.to));if(t!=2&&!o.every(r=>r))return{changes:e.changes(n.map((r,s)=>o[s]?[]:[{from:r.from,insert:i[s].open+" "},{from:r.to,insert:" "+i[s].close}]))};if(t!=1&&o.some(r=>r)){let r=[];for(let s=0,l;s<o.length;s++)if(l=o[s]){let a=i[s],{open:c,close:f}=l;r.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:f.pos-f.margin,to:f.pos+a.close.length})}return{changes:r}}return null}function uo(t,e,n=e.selection.ranges){let i=[],o=-1;for(let{from:r,to:s}of n){let l=i.length,a=1e9,c=It(e,r).line;if(c){for(let f=r;f<=s;){let h=e.doc.lineAt(f);if(h.from>o&&(r==s||s>h.from)){o=h.from;let u=/^\s*/.exec(h.text)[0].length,d=u==h.length,g=h.text.slice(u,u+c.length)==c?u:-1;u<h.text.length&&u<a&&(a=u),i.push({line:h,comment:g,token:c,indent:u,empty:d,single:!1})}f=h.to+1}if(a<1e9)for(let f=l;f<i.length;f++)i[f].indent<i[f].line.text.length&&(i[f].indent=a);i.length==l+1&&(i[l].single=!0)}}if(t!=2&&i.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:l,token:a,indent:c,empty:f,single:h}of i)(h||!f)&&r.push({from:l.from+c,insert:a+" "});let s=e.changes(r);return{changes:s,selection:e.selection.map(s,1)}}else if(t!=1&&i.some(r=>r.comment>=0)){let r=[];for(let{line:s,comment:l,token:a}of i)if(l>=0){let c=s.from+l,f=c+a.length;s.text[f-s.from]==" "&&f++,r.push({from:c,to:f})}return{changes:r}}return null}const dt=Qe.define(),mo=Qe.define(),po=he.define(),kn=he.define({combine(t){return Be(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(i,o)=>e(i,o)||n(i,o)})}}),Cn=ue.define({create(){return K.empty},update(t,e){let n=e.state.facet(kn),i=e.annotation(dt);if(i){let a=T.fromTransaction(e,i.selection),c=i.side,f=c==0?t.undone:t.done;return a?f=$e(f,f.length,n.minDepth,a):f=Ln(f,e.startState.selection),new K(c==0?i.rest:f,c==0?f:i.rest)}let o=e.annotation(mo);if((o=="full"||o=="before")&&(t=t.isolate()),e.annotation(ot.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let r=T.fromTransaction(e),s=e.annotation(ot.time),l=e.annotation(ot.userEvent);return r?t=t.addChanges(r,s,l,n,e):e.selection&&(t=t.addSelection(e.startState.selection,s,l,n.newGroupDelay)),(o=="full"||o=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new K(t.done.map(T.fromJSON),t.undone.map(T.fromJSON))}});function vn(t={}){return[Cn,kn.of(t),y.domEventHandlers({beforeinput(e,n){let i=e.inputType=="historyUndo"?An:e.inputType=="historyRedo"?mt:null;return i?(e.preventDefault(),i(n)):!1}})]}function Ye(t,e){return function({state:n,dispatch:i}){if(!e&&n.readOnly)return!1;let o=n.field(Cn,!1);if(!o)return!1;let r=o.pop(t,n,e);return r?(i(r),!0):!1}}const An=Ye(0,!1),mt=Ye(1,!1),go=Ye(0,!0),yo=Ye(1,!0);class T{constructor(e,n,i,o,r){this.changes=e,this.effects=n,this.mapped=i,this.startSelection=o,this.selectionsAfter=r}setSelAfter(e){return new T(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(o=>o.toJSON())}}static fromJSON(e){return new T(e.changes&&Pi.fromJSON(e.changes),[],e.mapped&&Wi.fromJSON(e.mapped),e.startSelection&&p.fromJSON(e.startSelection),e.selectionsAfter.map(p.fromJSON))}static fromTransaction(e,n){let i=F;for(let o of e.startState.facet(po)){let r=o(e);r.length&&(i=i.concat(r))}return!i.length&&e.changes.empty?null:new T(e.changes.invert(e.startState.doc),i,void 0,n||e.startState.selection,F)}static selection(e){return new T(void 0,F,void 0,void 0,e)}}function $e(t,e,n,i){let o=e+1>n+20?e-n-1:0,r=t.slice(o,e);return r.push(i),r}function xo(t,e){let n=[],i=!1;return t.iterChangedRanges((o,r)=>n.push(o,r)),e.iterChangedRanges((o,r,s,l)=>{for(let a=0;a<n.length;){let c=n[a++],f=n[a++];l>=c&&s<=f&&(i=!0)}}),i}function bo(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,i)=>n.empty!=e.ranges[i].empty).length===0}function Mn(t,e){return t.length?e.length?t.concat(e):t:e}const F=[],So=200;function Ln(t,e){if(t.length){let n=t[t.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-So));return i.length&&i[i.length-1].eq(e)?t:(i.push(e),$e(t,t.length-1,1e9,n.setSelAfter(i)))}else return[T.selection([e])]}function ko(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function rt(t,e){if(!t.length)return t;let n=t.length,i=F;for(;n;){let o=Co(t[n-1],e,i);if(o.changes&&!o.changes.empty||o.effects.length){let r=t.slice(0,n);return r[n-1]=o,r}else e=o.mapped,n--,i=o.selectionsAfter}return i.length?[T.selection(i)]:F}function Co(t,e,n){let i=Mn(t.selectionsAfter.length?t.selectionsAfter.map(l=>l.map(e)):F,n);if(!t.changes)return T.selection(i);let o=t.changes.map(e),r=e.mapDesc(t.changes,!0),s=t.mapped?t.mapped.composeDesc(r):r;return new T(o,M.mapEffects(t.effects,e),s,t.startSelection.map(r),i)}const vo=/^(input\.type|delete)($|\.)/;class K{constructor(e,n,i=0,o=void 0){this.done=e,this.undone=n,this.prevTime=i,this.prevUserEvent=o}isolate(){return this.prevTime?new K(this.done,this.undone):this}addChanges(e,n,i,o,r){let s=this.done,l=s[s.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!i||vo.test(i))&&(!l.selectionsAfter.length&&n-this.prevTime<o.newGroupDelay&&o.joinToEvent(r,xo(l.changes,e.changes))||i=="input.type.compose")?s=$e(s,s.length-1,o.minDepth,new T(e.changes.compose(l.changes),Mn(e.effects,l.effects),l.mapped,l.startSelection,F)):s=$e(s,s.length,o.minDepth,e),new K(s,F,n,i)}addSelection(e,n,i,o){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:F;return r.length>0&&n-this.prevTime<o&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&bo(r[r.length-1],e)?this:new K(Ln(this.done,e),this.undone,n,i)}addMapping(e){return new K(rt(this.done,e),rt(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,i){let o=e==0?this.done:this.undone;if(o.length==0)return null;let r=o[o.length-1],s=r.selectionsAfter[0]||n.selection;if(i&&r.selectionsAfter.length)return n.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:dt.of({side:e,rest:ko(o),selection:s}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let l=o.length==1?F:o.slice(0,o.length-1);return r.mapped&&(l=rt(l,r.mapped)),n.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:dt.of({side:e,rest:l,selection:s}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}K.empty=new K(F,F);const Bn=[{key:"Mod-z",run:An,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:mt,preventDefault:!0},{linux:"Ctrl-Shift-z",run:mt,preventDefault:!0},{key:"Mod-u",run:go,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:yo,preventDefault:!0}];function me(t,e){return p.create(t.ranges.map(e),t.mainIndex)}function j(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function H({state:t,dispatch:e},n){let i=me(t.selection,n);return i.eq(t.selection,!0)?!1:(e(j(t,i)),!0)}function Xe(t,e){return p.cursor(e?t.to:t.from)}function wn(t,e){return H(t,n=>n.empty?t.moveByChar(n,e):Xe(n,e))}function L(t){return t.textDirectionAt(t.state.selection.main.head)==pn.LTR}const Dn=t=>wn(t,!L(t)),En=t=>wn(t,L(t));function Tn(t,e){return H(t,n=>n.empty?t.moveByGroup(n,e):Xe(n,e))}const Ao=t=>Tn(t,!L(t)),Mo=t=>Tn(t,L(t));function Lo(t,e,n){if(e.type.prop(n))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Ze(t,e,n){let i=de(t).resolveInner(e.head),o=n?ft.closedBy:ft.openedBy;for(let a=e.head;;){let c=n?i.childAfter(a):i.childBefore(a);if(!c)break;Lo(t,c,o)?i=c:a=n?c.to:c.from}let r=i.type.prop(o),s,l;return r&&(s=n?re(t,i.from,1):re(t,i.to,-1))&&s.matched?l=n?s.end.to:s.end.from:l=n?i.to:i.from,p.cursor(l,n?-1:1)}const Bo=t=>H(t,e=>Ze(t.state,e,!L(t))),wo=t=>H(t,e=>Ze(t.state,e,L(t)));function In(t,e){return H(t,n=>{if(!n.empty)return Xe(n,e);let i=t.moveVertically(n,e);return i.head!=n.head?i:t.moveToLineBoundary(n,e)})}const On=t=>In(t,!1),Rn=t=>In(t,!0);function Pn(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,i=0,o;if(e){for(let r of t.state.facet(y.scrollMargins)){let s=r(t);s!=null&&s.top&&(n=Math.max(s==null?void 0:s.top,n)),s!=null&&s.bottom&&(i=Math.max(s==null?void 0:s.bottom,i))}o=t.scrollDOM.clientHeight-n-i}else o=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:i,selfScroll:e,height:Math.max(t.defaultLineHeight,o-5)}}function Wn(t,e){let n=Pn(t),{state:i}=t,o=me(i.selection,s=>s.empty?t.moveVertically(s,e,n.height):Xe(s,e));if(o.eq(i.selection))return!1;let r;if(n.selfScroll){let s=t.coordsAtPos(i.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),a=l.top+n.marginTop,c=l.bottom-n.marginBottom;s&&s.top>a&&s.bottom<c&&(r=y.scrollIntoView(o.main.head,{y:"start",yMargin:s.top-a}))}return t.dispatch(j(i,o),{effects:r}),!0}const Ht=t=>Wn(t,!1),pt=t=>Wn(t,!0);function Y(t,e,n){let i=t.lineBlockAt(e.head),o=t.moveToLineBoundary(e,n);if(o.head==e.head&&o.head!=(n?i.to:i.from)&&(o=t.moveToLineBoundary(e,n,!1)),!n&&o.head==i.from&&i.length){let r=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;r&&e.head!=i.from+r&&(o=p.cursor(i.from+r))}return o}const Do=t=>H(t,e=>Y(t,e,!0)),Eo=t=>H(t,e=>Y(t,e,!1)),To=t=>H(t,e=>Y(t,e,!L(t))),Io=t=>H(t,e=>Y(t,e,L(t))),Oo=t=>H(t,e=>p.cursor(t.lineBlockAt(e.head).from,1)),Ro=t=>H(t,e=>p.cursor(t.lineBlockAt(e.head).to,-1));function Po(t,e,n){let i=!1,o=me(t.selection,r=>{let s=re(t,r.head,-1)||re(t,r.head,1)||r.head>0&&re(t,r.head-1,1)||r.head<t.doc.length&&re(t,r.head+1,-1);if(!s||!s.end)return r;i=!0;let l=s.start.from==r.head?s.end.to:s.end.from;return p.cursor(l)});return i?(e(j(t,o)),!0):!1}const Wo=({state:t,dispatch:e})=>Po(t,e);function N(t,e){let n=me(t.state.selection,i=>{let o=e(i);return p.range(i.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(j(t.state,n)),!0)}function Fn(t,e){return N(t,n=>t.moveByChar(n,e))}const Nn=t=>Fn(t,!L(t)),$n=t=>Fn(t,L(t));function Un(t,e){return N(t,n=>t.moveByGroup(n,e))}const Fo=t=>Un(t,!L(t)),No=t=>Un(t,L(t)),$o=t=>N(t,e=>Ze(t.state,e,!L(t))),Uo=t=>N(t,e=>Ze(t.state,e,L(t)));function Hn(t,e){return N(t,n=>t.moveVertically(n,e))}const qn=t=>Hn(t,!1),zn=t=>Hn(t,!0);function Vn(t,e){return N(t,n=>t.moveVertically(n,e,Pn(t).height))}const qt=t=>Vn(t,!1),zt=t=>Vn(t,!0),Ho=t=>N(t,e=>Y(t,e,!0)),qo=t=>N(t,e=>Y(t,e,!1)),zo=t=>N(t,e=>Y(t,e,!L(t))),Vo=t=>N(t,e=>Y(t,e,L(t))),Ko=t=>N(t,e=>p.cursor(t.lineBlockAt(e.head).from)),jo=t=>N(t,e=>p.cursor(t.lineBlockAt(e.head).to)),Vt=({state:t,dispatch:e})=>(e(j(t,{anchor:0})),!0),Kt=({state:t,dispatch:e})=>(e(j(t,{anchor:t.doc.length})),!0),jt=({state:t,dispatch:e})=>(e(j(t,{anchor:t.selection.main.anchor,head:0})),!0),Gt=({state:t,dispatch:e})=>(e(j(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),Go=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),Jo=({state:t,dispatch:e})=>{let n=et(t).map(({from:i,to:o})=>p.range(i,Math.min(o+1,t.doc.length)));return e(t.update({selection:p.create(n),userEvent:"select"})),!0},Qo=({state:t,dispatch:e})=>{let n=me(t.selection,i=>{var o;let r=de(t).resolveStack(i.from,1);for(let s=r;s;s=s.next){let{node:l}=s;if((l.from<i.from&&l.to>=i.to||l.to>i.to&&l.from<=i.from)&&(!((o=l.parent)===null||o===void 0)&&o.parent))return p.range(l.to,l.from)}return i});return e(j(t,n)),!0},_o=({state:t,dispatch:e})=>{let n=t.selection,i=null;return n.ranges.length>1?i=p.create([n.main]):n.main.empty||(i=p.create([p.cursor(n.main.head)])),i?(e(j(t,i)),!0):!1};function we(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:i}=t,o=i.changeByRange(r=>{let{from:s,to:l}=r;if(s==l){let a=e(r);a<s?(n="delete.backward",a=Ie(t,a,!1)):a>s&&(n="delete.forward",a=Ie(t,a,!0)),s=Math.min(s,a),l=Math.max(l,a)}else s=Ie(t,s,!1),l=Ie(t,l,!0);return s==l?{range:r}:{changes:{from:s,to:l},range:p.cursor(s,s<r.head?-1:1)}});return o.changes.empty?!1:(t.dispatch(i.update(o,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?y.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Ie(t,e,n){if(t instanceof y)for(let i of t.state.facet(y.atomicRanges).map(o=>o(t)))i.between(e,e,(o,r)=>{o<e&&r>e&&(e=n?r:o)});return e}const Kn=(t,e,n)=>we(t,i=>{let o=i.from,{state:r}=t,s=r.doc.lineAt(o),l,a;if(n&&!e&&o>s.from&&o<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,o-s.from))){if(l[l.length-1]=="	")return o-1;let c=Mt(l,r.tabSize),f=c%ht(r)||ht(r);for(let h=0;h<f&&l[l.length-1-h]==" ";h++)o--;a=o}else a=ee(s.text,o-s.from,e,e)+s.from,a==o&&s.number!=(e?r.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(a-s.from,o-s.from))&&(a=ee(s.text,a-s.from,!1,!1)+s.from);return a}),gt=t=>Kn(t,!1,!0),jn=t=>Kn(t,!0,!1),Gn=(t,e)=>we(t,n=>{let i=n.head,{state:o}=t,r=o.doc.lineAt(i),s=o.charCategorizer(i);for(let l=null;;){if(i==(e?r.to:r.from)){i==n.head&&r.number!=(e?o.doc.lines:1)&&(i+=e?1:-1);break}let a=ee(r.text,i-r.from,e)+r.from,c=r.text.slice(Math.min(i,a)-r.from,Math.max(i,a)-r.from),f=s(c);if(l!=null&&f!=l)break;(c!=" "||i!=n.head)&&(l=f),i=a}return i}),Jn=t=>Gn(t,!1),Yo=t=>Gn(t,!0),Xo=t=>we(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),Zo=t=>we(t,e=>{let n=t.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),er=t=>we(t,e=>{let n=t.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),tr=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:dn.of(["",""])},range:p.cursor(i.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},nr=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>{if(!i.empty||i.from==0||i.from==t.doc.length)return{range:i};let o=i.from,r=t.doc.lineAt(o),s=o==r.from?o-1:ee(r.text,o-r.from,!1)+r.from,l=o==r.to?o+1:ee(r.text,o-r.from,!0)+r.from;return{changes:{from:s,to:l,insert:t.doc.slice(o,l).append(t.doc.slice(s,o))},range:p.cursor(l)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function et(t){let e=[],n=-1;for(let i of t.selection.ranges){let o=t.doc.lineAt(i.from),r=t.doc.lineAt(i.to);if(!i.empty&&i.to==r.from&&(r=t.doc.lineAt(i.to-1)),n>=o.number){let s=e[e.length-1];s.to=r.to,s.ranges.push(i)}else e.push({from:o.from,to:r.to,ranges:[i]});n=r.number+1}return e}function Qn(t,e,n){if(t.readOnly)return!1;let i=[],o=[];for(let r of et(t)){if(n?r.to==t.doc.length:r.from==0)continue;let s=t.doc.lineAt(n?r.to+1:r.from-1),l=s.length+1;if(n){i.push({from:r.to,to:s.to},{from:r.from,insert:s.text+t.lineBreak});for(let a of r.ranges)o.push(p.range(Math.min(t.doc.length,a.anchor+l),Math.min(t.doc.length,a.head+l)))}else{i.push({from:s.from,to:r.from},{from:r.to,insert:t.lineBreak+s.text});for(let a of r.ranges)o.push(p.range(a.anchor-l,a.head-l))}}return i.length?(e(t.update({changes:i,scrollIntoView:!0,selection:p.create(o,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const ir=({state:t,dispatch:e})=>Qn(t,e,!1),or=({state:t,dispatch:e})=>Qn(t,e,!0);function _n(t,e,n){if(t.readOnly)return!1;let i=[];for(let o of et(t))n?i.push({from:o.from,insert:t.doc.slice(o.from,o.to)+t.lineBreak}):i.push({from:o.to,insert:t.lineBreak+t.doc.slice(o.from,o.to)});return e(t.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const rr=({state:t,dispatch:e})=>_n(t,e,!1),sr=({state:t,dispatch:e})=>_n(t,e,!0),lr=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(et(e).map(({from:o,to:r})=>(o>0?o--:r<e.doc.length&&r++,{from:o,to:r}))),i=me(e.selection,o=>{let r;if(t.lineWrapping){let s=t.lineBlockAt(o.head),l=t.coordsAtPos(o.head,o.assoc||1);l&&(r=s.bottom+t.documentTop-l.bottom+t.defaultLineHeight/2)}return t.moveVertically(o,!0,r)}).map(n);return t.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function ar(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=de(t).resolveInner(e),i=n.childBefore(e),o=n.childAfter(e),r;return i&&o&&i.to<=e&&o.from>=e&&(r=i.type.prop(ft.closedBy))&&r.indexOf(o.name)>-1&&t.doc.lineAt(i.to).from==t.doc.lineAt(o.from).from&&!/\S/.test(t.sliceDoc(i.to,o.from))?{from:i.to,to:o.from}:null}const cr=Yn(!1),fr=Yn(!0);function Yn(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(o=>{let{from:r,to:s}=o,l=e.doc.lineAt(r),a=!t&&r==s&&ar(e,r);t&&(r=s=(s<=l.to?l:e.doc.lineAt(s)).to);let c=new hn(e,{simulateBreak:r,simulateDoubleBreak:!!a}),f=un(c,r);for(f==null&&(f=Mt(/^\s*/.exec(e.doc.lineAt(r).text)[0],e.tabSize));s<l.to&&/\s/.test(l.text[s-l.from]);)s++;a?{from:r,to:s}=a:r>l.from&&r<l.from+100&&!/\S/.test(l.text.slice(0,r))&&(r=l.from);let h=["",Ne(e,f)];return a&&h.push(Ne(e,c.lineIndent(l.from,-1))),{changes:{from:r,to:s,insert:dn.of(h)},range:p.cursor(r+1+h[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Ot(t,e){let n=-1;return t.changeByRange(i=>{let o=[];for(let s=i.from;s<=i.to;){let l=t.doc.lineAt(s);l.number>n&&(i.empty||i.to>l.from)&&(e(l,o,i),n=l.number),s=l.to+1}let r=t.changes(o);return{changes:o,range:p.range(r.mapPos(i.anchor,1),r.mapPos(i.head,1))}})}const hr=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=Object.create(null),i=new hn(t,{overrideIndentation:r=>{let s=n[r];return s??-1}}),o=Ot(t,(r,s,l)=>{let a=un(i,r.from);if(a==null)return;/\S/.test(r.text)||(a=0);let c=/^\s*/.exec(r.text)[0],f=Ne(t,a);(c!=f||l.from<r.from+c.length)&&(n[r.from]=a,s.push({from:r.from,to:r.from+c.length,insert:f}))});return o.changes.empty||e(t.update(o,{userEvent:"indent"})),!0},Xn=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(Ot(t,(n,i)=>{i.push({from:n.from,insert:t.facet(mn)})}),{userEvent:"input.indent"})),!0),Zn=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(Ot(t,(n,i)=>{let o=/^\s*/.exec(n.text)[0];if(!o)return;let r=Mt(o,t.tabSize),s=0,l=Ne(t,Math.max(0,r-ht(t)));for(;s<o.length&&s<l.length&&o.charCodeAt(s)==l.charCodeAt(s);)s++;i.push({from:n.from+s,to:n.from+o.length,insert:l.slice(s)})}),{userEvent:"delete.dedent"})),!0),ur=t=>(t.setTabFocusMode(),!0),dr=[{key:"Ctrl-b",run:Dn,shift:Nn,preventDefault:!0},{key:"Ctrl-f",run:En,shift:$n},{key:"Ctrl-p",run:On,shift:qn},{key:"Ctrl-n",run:Rn,shift:zn},{key:"Ctrl-a",run:Oo,shift:Ko},{key:"Ctrl-e",run:Ro,shift:jo},{key:"Ctrl-d",run:jn},{key:"Ctrl-h",run:gt},{key:"Ctrl-k",run:Xo},{key:"Ctrl-Alt-h",run:Jn},{key:"Ctrl-o",run:tr},{key:"Ctrl-t",run:nr},{key:"Ctrl-v",run:pt}],mr=[{key:"ArrowLeft",run:Dn,shift:Nn,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Ao,shift:Fo,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:To,shift:zo,preventDefault:!0},{key:"ArrowRight",run:En,shift:$n,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Mo,shift:No,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Io,shift:Vo,preventDefault:!0},{key:"ArrowUp",run:On,shift:qn,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Vt,shift:jt},{mac:"Ctrl-ArrowUp",run:Ht,shift:qt},{key:"ArrowDown",run:Rn,shift:zn,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Kt,shift:Gt},{mac:"Ctrl-ArrowDown",run:pt,shift:zt},{key:"PageUp",run:Ht,shift:qt},{key:"PageDown",run:pt,shift:zt},{key:"Home",run:Eo,shift:qo,preventDefault:!0},{key:"Mod-Home",run:Vt,shift:jt},{key:"End",run:Do,shift:Ho,preventDefault:!0},{key:"Mod-End",run:Kt,shift:Gt},{key:"Enter",run:cr},{key:"Mod-a",run:Go},{key:"Backspace",run:gt,shift:gt},{key:"Delete",run:jn},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Jn},{key:"Mod-Delete",mac:"Alt-Delete",run:Yo},{mac:"Mod-Backspace",run:Zo},{mac:"Mod-Delete",run:er}].concat(dr.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),ei=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Bo,shift:$o},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:wo,shift:Uo},{key:"Alt-ArrowUp",run:ir},{key:"Shift-Alt-ArrowUp",run:rr},{key:"Alt-ArrowDown",run:or},{key:"Shift-Alt-ArrowDown",run:sr},{key:"Escape",run:_o},{key:"Mod-Enter",run:fr},{key:"Alt-l",mac:"Ctrl-l",run:Jo},{key:"Mod-i",run:Qo,preventDefault:!0},{key:"Mod-[",run:Zn},{key:"Mod-]",run:Xn},{key:"Mod-Alt-\\",run:hr},{key:"Shift-Mod-k",run:lr},{key:"Shift-Mod-\\",run:Wo},{key:"Mod-/",run:so},{key:"Alt-A",run:ao},{key:"Ctrl-m",mac:"Shift-Alt-m",run:ur}].concat(mr),pr={key:"Tab",run:Xn,shift:Zn};function x(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var o=n[i];typeof o=="string"?t.setAttribute(i,o):o!=null&&(t[i]=o)}e++}for(;e<arguments.length;e++)ti(t,arguments[e]);return t}function ti(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)ti(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const Jt=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class ce{constructor(e,n,i=0,o=e.length,r,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,o),this.bufferStart=i,this.normalize=r?l=>r(Jt(l)):Jt,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return W(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=Bt(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=J(e);let o=this.normalize(n);for(let r=0,s=i;;r++){let l=o.charCodeAt(r),a=this.match(l,s,this.bufferPos+this.bufferStart);if(r==o.length-1){if(a)return this.value=a,this;break}s==i&&r<n.length&&n.charCodeAt(r)==l&&s++}}}match(e,n,i){let o=null;for(let r=0;r<this.matches.length;r+=2){let s=this.matches[r],l=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?o={from:this.matches[r+1],to:i}:(this.matches[r]++,l=!0)),l||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?o={from:n,to:i}:this.matches.push(1,n)),o&&this.test&&!this.test(o.from,o.to,this.buffer,this.bufferStart)&&(o=null),o}}typeof Symbol<"u"&&(ce.prototype[Symbol.iterator]=function(){return this});const ni={from:-1,to:-1,match:/.*/.exec("")},Rt="gm"+(/x/.unicode==null?"":"u");class ii{constructor(e,n,i,o=0,r=e.length){if(this.text=e,this.to=r,this.curLine="",this.done=!1,this.value=ni,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new oi(e,n,i,o,r);this.re=new RegExp(n,Rt+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let s=e.lineAt(o);this.curLineStart=s.from,this.matchPos=Ue(e,o),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let i=this.curLineStart+n.index,o=i+n[0].length;if(this.matchPos=Ue(this.text,o+(i==o?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<o||i>this.value.to)&&(!this.test||this.test(i,o,n)))return this.value={from:i,to:o,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const st=new WeakMap;class le{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,i){let o=st.get(e);if(!o||o.from>=i||o.to<=n){let l=new le(n,e.sliceString(n,i));return st.set(e,l),l}if(o.from==n&&o.to==i)return o;let{text:r,from:s}=o;return s>n&&(r=e.sliceString(n,s)+r,s=n),o.to<i&&(r+=e.sliceString(o.to,i)),st.set(e,new le(s,r)),new le(n,r.slice(n-s,i-s))}}class oi{constructor(e,n,i,o,r){this.text=e,this.to=r,this.done=!1,this.value=ni,this.matchPos=Ue(e,o),this.re=new RegExp(n,Rt+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=le.get(e,o,this.chunkEnd(o+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let i=this.flat.from+n.index,o=i+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,o,n)))return this.value={from:i,to:o,match:n},this.matchPos=Ue(this.text,o+(i==o?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=le.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(ii.prototype[Symbol.iterator]=oi.prototype[Symbol.iterator]=function(){return this});function gr(t){try{return new RegExp(t,Rt),!0}catch{return!1}}function Ue(t,e){if(e>=t.length)return e;let n=t.lineAt(e),i;for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function yt(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=x("input",{class:"cm-textfield",name:"line",value:e}),i=x("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),t.dispatch({effects:He.of(!1)}),t.focus()):r.keyCode==13&&(r.preventDefault(),o())},onsubmit:r=>{r.preventDefault(),o()}},x("label",t.state.phrase("Go to line"),": ",n)," ",x("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function o(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!r)return;let{state:s}=t,l=s.doc.lineAt(s.selection.main.head),[,a,c,f,h]=r,u=f?+f.slice(1):0,d=c?+c:l.number;if(c&&h){let R=d/100;a&&(R=R*(a=="-"?-1:1)+l.number/s.doc.lines),d=Math.round(s.doc.lines*R)}else c&&a&&(d=d*(a=="-"?-1:1)+l.number);let g=s.doc.line(Math.max(1,Math.min(s.doc.lines,d))),S=p.cursor(g.from+Math.max(0,Math.min(u,g.length)));t.dispatch({effects:[He.of(!1),y.scrollIntoView(S.from,{y:"center"})],selection:S}),t.focus()}return{dom:i}}const He=M.define(),Qt=ue.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(He)&&(t=n.value);return t},provide:t=>Dt.from(t,e=>e?yt:null)}),yr=t=>{let e=Se(t,yt);if(!e){let n=[He.of(!0)];t.state.field(Qt,!1)==null&&n.push(M.appendConfig.of([Qt,xr])),t.dispatch({effects:n}),e=Se(t,yt)}return e&&e.dom.querySelector("input").select(),!0},xr=y.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),br={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Sr=he.define({combine(t){return Be(t,br,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function kr(t){return[Lr,Mr]}const Cr=k.mark({class:"cm-selectionMatch"}),vr=k.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function _t(t,e,n,i){return(n==0||t(e.sliceDoc(n-1,n))!=w.Word)&&(i==e.doc.length||t(e.sliceDoc(i,i+1))!=w.Word)}function Ar(t,e,n,i){return t(e.sliceDoc(n,n+1))==w.Word&&t(e.sliceDoc(i-1,i))==w.Word}const Mr=Lt.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(Sr),{state:n}=t,i=n.selection;if(i.ranges.length>1)return k.none;let o=i.main,r,s=null;if(o.empty){if(!e.highlightWordAroundCursor)return k.none;let a=n.wordAt(o.head);if(!a)return k.none;s=n.charCategorizer(o.head),r=n.sliceDoc(a.from,a.to)}else{let a=o.to-o.from;if(a<e.minSelectionLength||a>200)return k.none;if(e.wholeWords){if(r=n.sliceDoc(o.from,o.to),s=n.charCategorizer(o.head),!(_t(s,n,o.from,o.to)&&Ar(s,n,o.from,o.to)))return k.none}else if(r=n.sliceDoc(o.from,o.to),!r)return k.none}let l=[];for(let a of t.visibleRanges){let c=new ce(n.doc,r,a.from,a.to);for(;!c.next().done;){let{from:f,to:h}=c.value;if((!s||_t(s,n,f,h))&&(o.empty&&f<=o.from&&h>=o.to?l.push(vr.range(f,h)):(f>=o.to||h<=o.from)&&l.push(Cr.range(f,h)),l.length>e.maxMatches))return k.none}}return k.set(l)}},{decorations:t=>t.decorations}),Lr=y.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Br=({state:t,dispatch:e})=>{let{selection:n}=t,i=p.create(n.ranges.map(o=>t.wordAt(o.head)||p.cursor(o.head)),n.mainIndex);return i.eq(n)?!1:(e(t.update({selection:i})),!0)};function wr(t,e){let{main:n,ranges:i}=t.selection,o=t.wordAt(n.head),r=o&&o.from==n.from&&o.to==n.to;for(let s=!1,l=new ce(t.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(s)return null;l=new ce(t.doc,e,0,Math.max(0,i[i.length-1].from-1)),s=!0}else{if(s&&i.some(a=>a.from==l.value.from))continue;if(r){let a=t.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const Dr=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(r=>r.from===r.to))return Br({state:t,dispatch:e});let i=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(r=>t.sliceDoc(r.from,r.to)!=i))return!1;let o=wr(t,i);return o?(e(t.update({selection:t.selection.addRange(p.range(o.from,o.to),!1),effects:y.scrollIntoView(o.to)})),!0):!1},pe=he.define({combine(t){return Be(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Hr(e),scrollToMatch:e=>y.scrollIntoView(e)})}});class ri{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||gr(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Or(this):new Tr(this)}getCursor(e,n=0,i){let o=e.doc?e:ke.create({doc:e});return i==null&&(i=o.doc.length),this.regexp?oe(this,o,n,i):ie(this,o,n,i)}}class si{constructor(e){this.spec=e}}function ie(t,e,n,i){return new ce(e.doc,t.unquoted,n,i,t.caseSensitive?void 0:o=>o.toLowerCase(),t.wholeWord?Er(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Er(t,e){return(n,i,o,r)=>((r>n||r+o.length<i)&&(r=Math.max(0,n-2),o=t.sliceString(r,Math.min(t.length,i+2))),(e(qe(o,n-r))!=w.Word||e(ze(o,n-r))!=w.Word)&&(e(ze(o,i-r))!=w.Word||e(qe(o,i-r))!=w.Word))}class Tr extends si{constructor(e){super(e)}nextMatch(e,n,i){let o=ie(this.spec,e,i,e.doc.length).nextOverlapping();return o.done&&(o=ie(this.spec,e,0,n).nextOverlapping()),o.done?null:o.value}prevMatchInRange(e,n,i){for(let o=i;;){let r=Math.max(n,o-1e4-this.spec.unquoted.length),s=ie(this.spec,e,r,o),l=null;for(;!s.nextOverlapping().done;)l=s.value;if(l)return l;if(r==n)return null;o-=1e4}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let i=ie(this.spec,e,0,e.doc.length),o=[];for(;!i.next().done;){if(o.length>=n)return null;o.push(i.value)}return o}highlight(e,n,i,o){let r=ie(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!r.next().done;)o(r.value.from,r.value.to)}}function oe(t,e,n,i){return new ii(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?Ir(e.charCategorizer(e.selection.main.head)):void 0},n,i)}function qe(t,e){return t.slice(ee(t,e,!1),e)}function ze(t,e){return t.slice(e,ee(t,e))}function Ir(t){return(e,n,i)=>!i[0].length||(t(qe(i.input,i.index))!=w.Word||t(ze(i.input,i.index))!=w.Word)&&(t(ze(i.input,i.index+i[0].length))!=w.Word||t(qe(i.input,i.index+i[0].length))!=w.Word)}class Or extends si{nextMatch(e,n,i){let o=oe(this.spec,e,i,e.doc.length).next();return o.done&&(o=oe(this.spec,e,0,n).next()),o.done?null:o.value}prevMatchInRange(e,n,i){for(let o=1;;o++){let r=Math.max(n,i-o*1e4),s=oe(this.spec,e,r,i),l=null;for(;!s.next().done;)l=s.value;if(l&&(r==n||l.from>r+10))return l;if(r==n)return null}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:n)}matchAll(e,n){let i=oe(this.spec,e,0,e.doc.length),o=[];for(;!i.next().done;){if(o.length>=n)return null;o.push(i.value)}return o}highlight(e,n,i,o){let r=oe(this.spec,e,Math.max(0,n-250),Math.min(i+250,e.doc.length));for(;!r.next().done;)o(r.value.from,r.value.to)}}const Ce=M.define(),Pt=M.define(),Q=ue.define({create(t){return new lt(xt(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Ce)?t=new lt(n.value.create(),t.panel):n.is(Pt)&&(t=new lt(t.query,n.value?Wt:null));return t},provide:t=>Dt.from(t,e=>e.panel)});class lt{constructor(e,n){this.query=e,this.panel=n}}const Rr=k.mark({class:"cm-searchMatch"}),Pr=k.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Wr=Lt.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Q))}update(t){let e=t.state.field(Q);(e!=t.startState.field(Q)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return k.none;let{view:n}=this,i=new Fi;for(let o=0,r=n.visibleRanges,s=r.length;o<s;o++){let{from:l,to:a}=r[o];for(;o<s-1&&a>r[o+1].from-2*250;)a=r[++o].to;t.highlight(n.state,l,a,(c,f)=>{let h=n.state.selection.ranges.some(u=>u.from==c&&u.to==f);i.add(c,f,h?Pr:Rr)})}return i.finish()}},{decorations:t=>t.decorations});function De(t){return e=>{let n=e.state.field(Q,!1);return n&&n.query.spec.valid?t(e,n):ci(e)}}const Ve=De((t,{query:e})=>{let{to:n}=t.state.selection.main,i=e.nextMatch(t.state,n,n);if(!i)return!1;let o=p.single(i.from,i.to),r=t.state.facet(pe);return t.dispatch({selection:o,effects:[Ft(t,i),r.scrollToMatch(o.main,t)],userEvent:"select.search"}),ai(t),!0}),Ke=De((t,{query:e})=>{let{state:n}=t,{from:i}=n.selection.main,o=e.prevMatch(n,i,i);if(!o)return!1;let r=p.single(o.from,o.to),s=t.state.facet(pe);return t.dispatch({selection:r,effects:[Ft(t,o),s.scrollToMatch(r.main,t)],userEvent:"select.search"}),ai(t),!0}),Fr=De((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:p.create(n.map(i=>p.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),Nr=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:o}=n.main,r=[],s=0;for(let l=new ce(t.doc,t.sliceDoc(i,o));!l.next().done;){if(r.length>1e3)return!1;l.value.from==i&&(s=r.length),r.push(p.range(l.value.from,l.value.to))}return e(t.update({selection:p.create(r,s),userEvent:"select.search.matches"})),!0},Yt=De((t,{query:e})=>{let{state:n}=t,{from:i,to:o}=n.selection.main;if(n.readOnly)return!1;let r=e.nextMatch(n,i,i);if(!r)return!1;let s=[],l,a,c=[];if(r.from==i&&r.to==o&&(a=n.toText(e.getReplacement(r)),s.push({from:r.from,to:r.to,insert:a}),r=e.nextMatch(n,r.from,r.to),c.push(y.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+"."))),r){let f=s.length==0||s[0].from>=r.to?0:r.to-r.from-a.length;l=p.single(r.from-f,r.to-f),c.push(Ft(t,r)),c.push(n.facet(pe).scrollToMatch(l.main,t))}return t.dispatch({changes:s,selection:l,effects:c,userEvent:"input.replace"}),!0}),$r=De((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(o=>{let{from:r,to:s}=o;return{from:r,to:s,insert:e.getReplacement(o)}});if(!n.length)return!1;let i=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:y.announce.of(i),userEvent:"input.replace.all"}),!0});function Wt(t){return t.state.facet(pe).createPanel(t)}function xt(t,e){var n,i,o,r,s;let l=t.selection.main,a=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=t.facet(pe);return new ri({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(o=e==null?void 0:e.literal)!==null&&o!==void 0?o:c.literal,regexp:(r=e==null?void 0:e.regexp)!==null&&r!==void 0?r:c.regexp,wholeWord:(s=e==null?void 0:e.wholeWord)!==null&&s!==void 0?s:c.wholeWord})}function li(t){let e=Se(t,Wt);return e&&e.dom.querySelector("[main-field]")}function ai(t){let e=li(t);e&&e==t.root.activeElement&&e.select()}const ci=t=>{let e=t.state.field(Q,!1);if(e&&e.panel){let n=li(t);if(n&&n!=t.root.activeElement){let i=xt(t.state,e.query.spec);i.valid&&t.dispatch({effects:Ce.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[Pt.of(!0),e?Ce.of(xt(t.state,e.query.spec)):M.appendConfig.of(zr)]});return!0},fi=t=>{let e=t.state.field(Q,!1);if(!e||!e.panel)return!1;let n=Se(t,Wt);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:Pt.of(!1)}),!0},Ur=[{key:"Mod-f",run:ci,scope:"editor search-panel"},{key:"F3",run:Ve,shift:Ke,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Ve,shift:Ke,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:fi,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Nr},{key:"Mod-Alt-g",run:yr},{key:"Mod-d",run:Dr,preventDefault:!0}];class Hr{constructor(e){this.view=e;let n=this.query=e.state.field(Q).query.spec;this.commit=this.commit.bind(this),this.searchField=x("input",{value:n.search,placeholder:I(e,"Find"),"aria-label":I(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=x("input",{value:n.replace,placeholder:I(e,"Replace"),"aria-label":I(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=x("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=x("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=x("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function i(o,r,s){return x("button",{class:"cm-button",name:o,onclick:r,type:"button"},s)}this.dom=x("div",{onkeydown:o=>this.keydown(o),class:"cm-search"},[this.searchField,i("next",()=>Ve(e),[I(e,"next")]),i("prev",()=>Ke(e),[I(e,"previous")]),i("select",()=>Fr(e),[I(e,"all")]),x("label",null,[this.caseField,I(e,"match case")]),x("label",null,[this.reField,I(e,"regexp")]),x("label",null,[this.wordField,I(e,"by word")]),...e.state.readOnly?[]:[x("br"),this.replaceField,i("replace",()=>Yt(e),[I(e,"replace")]),i("replaceAll",()=>$r(e),[I(e,"replace all")])],x("button",{name:"close",onclick:()=>fi(e),"aria-label":I(e,"close"),type:"button"},["×"])])}commit(){let e=new ri({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ce.of(e)}))}keydown(e){Ni(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Ke:Ve)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Yt(this.view))}update(e){for(let n of e.transactions)for(let i of n.effects)i.is(Ce)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(pe).top}}function I(t,e){return t.state.phrase(e)}const Oe=30,Re=/[\s\.,:;?!]/;function Ft(t,{from:e,to:n}){let i=t.state.doc.lineAt(e),o=t.state.doc.lineAt(n).to,r=Math.max(i.from,e-Oe),s=Math.min(o,n+Oe),l=t.state.sliceDoc(r,s);if(r!=i.from){for(let a=0;a<Oe;a++)if(!Re.test(l[a+1])&&Re.test(l[a])){l=l.slice(a);break}}if(s!=o){for(let a=l.length-1;a>l.length-Oe;a--)if(!Re.test(l[a-1])&&Re.test(l[a])){l=l.slice(0,a);break}}return y.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${i.number}.`)}const qr=y.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),zr=[Q,wt.low(Wr),qr];class hi{constructor(e,n,i){this.state=e,this.pos=n,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let n=de(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),i=Math.max(n.from,this.pos-250),o=n.text.slice(i-n.from,this.pos-n.from),r=o.search(ui(e,!1));return r<0?null:{from:i+r,to:this.pos,text:o.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(e,n){e=="abort"&&this.abortListeners&&this.abortListeners.push(n)}}function Xt(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Vr(t){let e=Object.create(null),n=Object.create(null);for(let{label:o}of t){e[o[0]]=!0;for(let r=1;r<o.length;r++)n[o[r]]=!0}let i=Xt(e)+Xt(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function Kr(t){let e=t.map(o=>typeof o=="string"?{label:o}:o),[n,i]=e.every(o=>/^\w+$/.test(o.label))?[/\w*$/,/\w+$/]:Vr(e);return o=>{let r=o.matchBefore(i);return r||o.explicit?{from:r?r.from:o.pos,options:e,validFor:n}:null}}class Zt{constructor(e,n,i,o){this.completion=e,this.source=n,this.match=i,this.score=o}}function _(t){return t.selection.main.from}function ui(t,e){var n;let{source:i}=t,o=e&&i[0]!="^",r=i[i.length-1]!="$";return!o&&!r?t:new RegExp(`${o?"^":""}(?:${i})${r?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const di=Qe.define();function jr(t,e,n,i){let{main:o}=t.selection,r=n-o.from,s=i-o.from;return Object.assign(Object.assign({},t.changeByRange(l=>l!=o&&n!=i&&t.sliceDoc(l.from+r,l.from+s)!=t.sliceDoc(n,i)?{range:l}:{changes:{from:l.from+r,to:i==o.from?l.to:l.from+s,insert:e},range:p.cursor(l.from+r+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const en=new WeakMap;function Gr(t){if(!Array.isArray(t))return t;let e=en.get(t);return e||en.set(t,e=Kr(t)),e}const je=M.define(),ve=M.define();class Jr{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let i=W(e,n),o=J(i);this.chars.push(i);let r=e.slice(n,n+o),s=r.toUpperCase();this.folded.push(W(s==r?r.toLowerCase():s,0)),n+=o}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:i,any:o,precise:r,byWord:s}=this;if(n.length==1){let b=W(e,0),$=J(b),D=$==e.length?0:-100;if(b!=n[0])if(b==i[0])D+=-200;else return null;return this.ret(D,[0,$])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=n.length,c=0;if(l<0){for(let b=0,$=Math.min(e.length,200);b<$&&c<a;){let D=W(e,b);(D==n[c]||D==i[c])&&(o[c++]=b),b+=J(D)}if(c<a)return null}let f=0,h=0,u=!1,d=0,g=-1,S=-1,R=/[a-z]/.test(e),q=!0;for(let b=0,$=Math.min(e.length,200),D=0;b<$&&h<a;){let C=W(e,b);l<0&&(f<a&&C==n[f]&&(r[f++]=b),d<a&&(C==n[d]||C==i[d]?(d==0&&(g=b),S=b+1,d++):d=0));let z,V=C<255?C>=48&&C<=57||C>=97&&C<=122?2:C>=65&&C<=90?1:0:(z=Bt(C))!=z.toLowerCase()?1:z!=z.toUpperCase()?2:0;(!b||V==1&&R||D==0&&V!=0)&&(n[h]==C||i[h]==C&&(u=!0)?s[h++]=b:s.length&&(q=!1)),D=V,b+=J(C)}return h==a&&s[0]==0&&q?this.result(-100+(u?-200:0),s,e):d==a&&g==0?this.ret(-200-e.length+(S==e.length?0:-100),[0,S]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[g,S]):h==a?this.result(-100+(u?-200:0)+-700+(q?0:-1100),s,e):n.length==2?null:this.result((o[0]?-700:0)+-200+-1100,o,e)}result(e,n,i){let o=[],r=0;for(let s of n){let l=s+(this.astral?J(W(i,s)):1);r&&o[r-1]==s?o[r-1]=l:(o[r++]=s,o[r++]=l)}return this.ret(e-i.length,o)}}class Qr{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),i=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,n.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const A=he.define({combine(t){return Be(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:_r,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>i=>tn(e(i),n(i)),optionClass:(e,n)=>i=>tn(e(i),n(i)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function tn(t,e){return t?e?t+" "+e:t:e}function _r(t,e,n,i,o,r){let s=t.textDirection==pn.RTL,l=s,a=!1,c="top",f,h,u=e.left-o.left,d=o.right-e.right,g=i.right-i.left,S=i.bottom-i.top;if(l&&u<Math.min(g,d)?l=!1:!l&&d<Math.min(g,u)&&(l=!0),g<=(l?u:d))f=Math.max(o.top,Math.min(n.top,o.bottom-S))-e.top,h=Math.min(400,l?u:d);else{a=!0,h=Math.min(400,(s?e.right:o.right-e.left)-30);let b=o.bottom-e.bottom;b>=S||b>e.top?f=n.bottom-e.top:(c="bottom",f=e.bottom-n.top)}let R=(e.bottom-e.top)/r.offsetHeight,q=(e.right-e.left)/r.offsetWidth;return{style:`${c}: ${f/R}px; max-width: ${h/q}px`,class:"cm-completionInfo-"+(a?s?"left-narrow":"right-narrow":l?"left":"right")}}function Yr(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),n.type&&i.classList.add(...n.type.split(/\s+/g).map(o=>"cm-completionIcon-"+o)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(n,i,o,r){let s=document.createElement("span");s.className="cm-completionLabel";let l=n.displayLabel||n.label,a=0;for(let c=0;c<r.length;){let f=r[c++],h=r[c++];f>a&&s.appendChild(document.createTextNode(l.slice(a,f)));let u=s.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(l.slice(f,h))),u.className="cm-completionMatchedText",a=h}return a<l.length&&s.appendChild(document.createTextNode(l.slice(a))),s},position:50},{render(n){if(!n.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),e.sort((n,i)=>n.position-i.position).map(n=>n.render)}function at(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let o=Math.floor(e/n);return{from:o*n,to:(o+1)*n}}let i=Math.floor((t-e)/n);return{from:t-(i+1)*n,to:t-i*n}}class Xr{constructor(e,n,i){this.view=e,this.stateField=n,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let o=e.state.field(n),{options:r,selected:s}=o.open,l=e.state.facet(A);this.optionContent=Yr(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=at(r.length,s,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(n).open;for(let f=a.target,h;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(h=/-(\d+)$/.exec(f.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(A).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:ve.of(null)})}),this.showOptions(r,o.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let i=e.state.field(this.stateField),o=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=o){let{options:r,selected:s,disabled:l}=i.open;(!o.open||o.open.options!=r)&&(this.range=at(r.length,s,e.state.facet(A).maxRenderedOptions),this.showOptions(r,i.id)),this.updateSel(),l!=((n=o.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of n.split(" "))i&&this.dom.classList.add(i);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=at(n.options.length,n.selected,this.view.state.facet(A).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:o}=i;if(!o)return;let r=typeof o=="string"?document.createTextNode(o):o(i);if(!r)return;"then"in r?r.then(s=>{s&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(s,i)}).catch(s=>ut(this.view.state,s,"completion info")):this.addInfoPane(r,i)}}addInfoPane(e,n){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:o,destroy:r}=e;i.appendChild(o),this.infoDestroy=r||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let i=this.list.firstChild,o=this.range.from;i;i=i.nextSibling,o++)i.nodeName!="LI"||!i.id?o--:o==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),n=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return n&&es(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),o=e.getBoundingClientRect(),r=this.space;if(!r){let s=this.dom.ownerDocument.defaultView||window;r={left:0,top:0,right:s.innerWidth,bottom:s.innerHeight}}return o.top>Math.min(r.bottom,n.bottom)-10||o.bottom<Math.max(r.top,n.top)+10?null:this.view.state.facet(A).positionInfo(this.view,n,o,i,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,i){const o=document.createElement("ul");o.id=n,o.setAttribute("role","listbox"),o.setAttribute("aria-expanded","true"),o.setAttribute("aria-label",this.view.state.phrase("Completions"));let r=null;for(let s=i.from;s<i.to;s++){let{completion:l,match:a}=e[s],{section:c}=l;if(c){let u=typeof c=="string"?c:c.name;if(u!=r&&(s>i.from||i.from==0))if(r=u,typeof c!="string"&&c.header)o.appendChild(c.header(c));else{let d=o.appendChild(document.createElement("completion-section"));d.textContent=u}}const f=o.appendChild(document.createElement("li"));f.id=n+"-"+s,f.setAttribute("role","option");let h=this.optionClass(l);h&&(f.className=h);for(let u of this.optionContent){let d=u(l,this.view.state,this.view,a);d&&f.appendChild(d)}}return i.from&&o.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&o.classList.add("cm-completionListIncompleteBottom"),o}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Zr(t,e){return n=>new Xr(n,t,e)}function es(t,e){let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=n.height/t.offsetHeight;i.top<n.top?t.scrollTop-=(n.top-i.top)/o:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/o)}function nn(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function ts(t,e){let n=[],i=null,o=c=>{n.push(c);let{section:f}=c.completion;if(f){i||(i=[]);let h=typeof f=="string"?f:f.name;i.some(u=>u.name==h)||i.push(typeof f=="string"?{name:h}:f)}},r=e.facet(A);for(let c of t)if(c.hasResult()){let f=c.result.getMatch;if(c.result.filter===!1)for(let h of c.result.options)o(new Zt(h,c.source,f?f(h):[],1e9-n.length));else{let h=e.sliceDoc(c.from,c.to),u,d=r.filterStrict?new Qr(h):new Jr(h);for(let g of c.result.options)if(u=d.match(g.label)){let S=g.displayLabel?f?f(g,u.matched):[]:u.matched;o(new Zt(g,c.source,S,u.score+(g.boost||0)))}}}if(i){let c=Object.create(null),f=0,h=(u,d)=>{var g,S;return((g=u.rank)!==null&&g!==void 0?g:1e9)-((S=d.rank)!==null&&S!==void 0?S:1e9)||(u.name<d.name?-1:1)};for(let u of i.sort(h))f-=1e5,c[u.name]=f;for(let u of n){let{section:d}=u.completion;d&&(u.score+=c[typeof d=="string"?d:d.name])}}let s=[],l=null,a=r.compareCompletions;for(let c of n.sort((f,h)=>h.score-f.score||a(f.completion,h.completion))){let f=c.completion;!l||l.label!=f.label||l.detail!=f.detail||l.type!=null&&f.type!=null&&l.type!=f.type||l.apply!=f.apply||l.boost!=f.boost?s.push(c):nn(c.completion)>nn(l)&&(s[s.length-1]=c),l=c.completion}return s}class se{constructor(e,n,i,o,r,s){this.options=e,this.attrs=n,this.tooltip=i,this.timestamp=o,this.selected=r,this.disabled=s}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new se(this.options,on(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,i,o,r){let s=ts(e,n);if(!s.length)return o&&e.some(a=>a.state==1)?new se(o.options,o.attrs,o.tooltip,o.timestamp,o.selected,!0):null;let l=n.facet(A).selectOnOpen?0:-1;if(o&&o.selected!=l&&o.selected!=-1){let a=o.options[o.selected].completion;for(let c=0;c<s.length;c++)if(s[c].completion==a){l=c;break}}return new se(s,on(i,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:ls,above:r.aboveCursor},o?o.timestamp:Date.now(),l,!1)}map(e){return new se(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Ge{constructor(e,n,i){this.active=e,this.id=n,this.open=i}static start(){return new Ge(rs,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,i=n.facet(A),r=(i.override||n.languageDataAt("autocomplete",_(n)).map(Gr)).map(l=>(this.active.find(c=>c.source==l)||new B(l,this.active.some(c=>c.state!=0)?1:0)).update(e,i));r.length==this.active.length&&r.every((l,a)=>l==this.active[a])&&(r=this.active);let s=this.open;s&&e.docChanged&&(s=s.map(e.changes)),e.selection||r.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!ns(r,this.active)?s=se.build(r,n,this.id,s,i):s&&s.disabled&&!r.some(l=>l.state==1)&&(s=null),!s&&r.every(l=>l.state!=1)&&r.some(l=>l.hasResult())&&(r=r.map(l=>l.hasResult()?new B(l.source,0):l));for(let l of e.effects)l.is(pi)&&(s=s&&s.setSelected(l.value,this.id));return r==this.active&&s==this.open?this:new Ge(r,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?is:os}}function ns(t,e){if(t==e)return!0;for(let n=0,i=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;i<e.length&&!e[i].hasResult;)i++;let o=n==t.length,r=i==e.length;if(o||r)return o==r;if(t[n++].result!=e[i++].result)return!1}}const is={"aria-autocomplete":"list"},os={};function on(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const rs=[];function bt(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(di);if(n&&e.activateOnCompletion(n))return"input"}return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}class B{constructor(e,n,i=-1){this.source=e,this.state=n,this.explicitPos=i}hasResult(){return!1}update(e,n){let i=bt(e,n),o=this;i?o=o.handleUserEvent(e,i,n):e.docChanged?o=o.handleChange(e):e.selection&&o.state!=0&&(o=new B(o.source,0));for(let r of e.effects)if(r.is(je))o=new B(o.source,1,r.value?_(e.state):-1);else if(r.is(ve))o=new B(o.source,0);else if(r.is(mi))for(let s of r.value)s.source==o.source&&(o=s);return o}handleUserEvent(e,n,i){return n=="delete"||!i.activateOnTyping?this.map(e.changes):new B(this.source,1)}handleChange(e){return e.changes.touchesRange(_(e.startState))?new B(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new B(this.source,this.state,e.mapPos(this.explicitPos))}}class ae extends B{constructor(e,n,i,o,r){super(e,2,n),this.result=i,this.from=o,this.to=r}hasResult(){return!0}handleUserEvent(e,n,i){var o;let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),l=e.changes.mapPos(this.to,1),a=_(e.state);if((this.explicitPos<0?a<=s:a<this.from)||a>l||!r||n=="delete"&&_(e.startState)==this.from)return new B(this.source,n=="input"&&i.activateOnTyping?1:0);let c=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return ss(r.validFor,e.state,s,l)?new ae(this.source,c,r,s,l):r.update&&(r=r.update(r,s,l,new hi(e.state,a,c>=0)))?new ae(this.source,c,r,r.from,(o=r.to)!==null&&o!==void 0?o:_(e.state)):new B(this.source,1,c)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new B(this.source,0):this.map(e.changes)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new ae(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new B(this.source,0)}}function ss(t,e,n,i){if(!t)return!1;let o=e.sliceDoc(n,i);return typeof t=="function"?t(o,n,i,e):ui(t,!0).test(o)}const mi=M.define({map(t,e){return t.map(n=>n.map(e))}}),pi=M.define(),E=ue.define({create(){return Ge.start()},update(t,e){return t.update(e)},provide:t=>[$i.from(t,e=>e.tooltip),y.contentAttributes.from(t,e=>e.attrs)]});function Nt(t,e){const n=e.completion.apply||e.completion.label;let i=t.state.field(E).active.find(o=>o.source==e.source);return i instanceof ae?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},jr(t.state,n,i.from,i.to)),{annotations:di.of(e.completion)})):n(t,e.completion,i.from,i.to),!0):!1}const ls=Zr(E,Nt);function Pe(t,e="option"){return n=>{let i=n.state.field(E,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(A).interactionDelay)return!1;let o=1,r;e=="page"&&(r=gn(n,i.open.tooltip))&&(o=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:s}=i.open.options,l=i.open.selected>-1?i.open.selected+o*(t?1:-1):t?0:s-1;return l<0?l=e=="page"?0:s-1:l>=s&&(l=e=="page"?s-1:0),n.dispatch({effects:pi.of(l)}),!0}}const as=t=>{let e=t.state.field(E,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(A).interactionDelay?!1:Nt(t,e.open.options[e.open.selected])},cs=t=>t.state.field(E,!1)?(t.dispatch({effects:je.of(!0)}),!0):!1,fs=t=>{let e=t.state.field(E,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:ve.of(null)}),!0)};class hs{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const us=50,ds=1e3,ms=Lt.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(E).active)e.state==1&&this.startQuery(e)}update(t){let e=t.state.field(E),n=t.state.facet(A);if(!t.selectionSet&&!t.docChanged&&t.startState.field(E)==e)return;let i=t.transactions.some(r=>(r.selection||r.docChanged)&&!bt(r,n));for(let r=0;r<this.running.length;r++){let s=this.running[r];if(i||s.updates.length+t.transactions.length>us&&Date.now()-s.time>ds){for(let l of s.context.abortListeners)try{l()}catch(a){ut(this.view.state,a)}s.context.abortListeners=null,this.running.splice(r--,1)}else s.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(r=>r.effects.some(s=>s.is(je)))&&(this.pendingStart=!0);let o=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(r=>r.state==1&&!this.running.some(s=>s.active.source==r.source))?setTimeout(()=>this.startUpdate(),o):-1,this.composing!=0)for(let r of t.transactions)bt(r,n)=="input"?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(E);for(let n of e.active)n.state==1&&!this.running.some(i=>i.active.source==n.source)&&this.startQuery(n)}startQuery(t){let{state:e}=this.view,n=_(e),i=new hi(e,n,t.explicitPos==n),o=new hs(t,i);this.running.push(o),Promise.resolve(t.source(i)).then(r=>{o.context.aborted||(o.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:ve.of(null)}),ut(this.view.state,r)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(A).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(A);for(let i=0;i<this.running.length;i++){let o=this.running[i];if(o.done===void 0)continue;if(this.running.splice(i--,1),o.done){let s=new ae(o.active.source,o.active.explicitPos,o.done,o.done.from,(t=o.done.to)!==null&&t!==void 0?t:_(o.updates.length?o.updates[0].startState:this.view.state));for(let l of o.updates)s=s.update(l,n);if(s.hasResult()){e.push(s);continue}}let r=this.view.state.field(E).active.find(s=>s.source==o.active.source);if(r&&r.state==1)if(o.done==null){let s=new B(o.active.source,0);for(let l of o.updates)s=s.update(l,n);s.state!=1&&e.push(s)}else this.startQuery(r)}e.length&&this.view.dispatch({effects:mi.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(E,!1);if(e&&e.tooltip&&this.view.state.facet(A).closeOnBlur){let n=e.open&&gn(this.view,e.open.tooltip);(!n||!n.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ve.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:je.of(!1)}),20),this.composing=0}}}),ps=typeof navigator=="object"&&/Win/.test(navigator.platform),gs=wt.highest(y.domEventHandlers({keydown(t,e){let n=e.state.field(E,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||t.key.length>1||t.ctrlKey&&!(ps&&t.altKey)||t.metaKey)return!1;let i=n.open.options[n.open.selected],o=n.active.find(s=>s.source==i.source),r=i.completion.commitCharacters||o.result.commitCharacters;return r&&r.indexOf(t.key)>-1&&Nt(e,i),!1}})),ys=y.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Ae={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Z=M.define({map(t,e){let n=e.mapPos(t,-1,Ui.TrackAfter);return n??void 0}}),$t=new class extends Hi{};$t.startSide=1;$t.endSide=-1;const gi=ue.define({create(){return qi.empty},update(t,e){if(t=t.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:i=>i>=n.from&&i<=n.to})}for(let n of e.effects)n.is(Z)&&(t=t.update({add:[$t.range(n.value,n.value+1)]}));return t}});function xs(){return[Ss,gi]}const ct="()[]{}<>";function yi(t){for(let e=0;e<ct.length;e+=2)if(ct.charCodeAt(e)==t)return ct.charAt(e+1);return Bt(t<128?t:t+1)}function xi(t,e){return t.languageDataAt("closeBrackets",e)[0]||Ae}const bs=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Ss=y.inputHandler.of((t,e,n,i)=>{if((bs?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let o=t.state.selection.main;if(i.length>2||i.length==2&&J(W(i,0))==1||e!=o.from||n!=o.to)return!1;let r=vs(t.state,i);return r?(t.dispatch(r),!0):!1}),ks=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=xi(t,t.selection.main.head).brackets||Ae.brackets,o=null,r=t.changeByRange(s=>{if(s.empty){let l=As(t.doc,s.head);for(let a of i)if(a==l&&tt(t.doc,s.head)==yi(W(a,0)))return{changes:{from:s.head-a.length,to:s.head+a.length},range:p.cursor(s.head-a.length)}}return{range:o=s}});return o||e(t.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!o},Cs=[{key:"Backspace",run:ks}];function vs(t,e){let n=xi(t,t.selection.main.head),i=n.brackets||Ae.brackets;for(let o of i){let r=yi(W(o,0));if(e==o)return r==o?Bs(t,o,i.indexOf(o+o+o)>-1,n):Ms(t,o,r,n.before||Ae.before);if(e==r&&bi(t,t.selection.main.from))return Ls(t,o,r)}return null}function bi(t,e){let n=!1;return t.field(gi).between(0,t.doc.length,i=>{i==e&&(n=!0)}),n}function tt(t,e){let n=t.sliceString(e,e+2);return n.slice(0,J(W(n,0)))}function As(t,e){let n=t.sliceString(e-2,e);return J(W(n,0))==n.length?n:n.slice(1)}function Ms(t,e,n,i){let o=null,r=t.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:n,from:s.to}],effects:Z.of(s.to+e.length),range:p.range(s.anchor+e.length,s.head+e.length)};let l=tt(t.doc,s.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+n,from:s.head},effects:Z.of(s.head+e.length),range:p.cursor(s.head+e.length)}:{range:o=s}});return o?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Ls(t,e,n){let i=null,o=t.changeByRange(r=>r.empty&&tt(t.doc,r.head)==n?{changes:{from:r.head,to:r.head+n.length,insert:n},range:p.cursor(r.head+n.length)}:i={range:r});return i?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Bs(t,e,n,i){let o=i.stringPrefixes||Ae.stringPrefixes,r=null,s=t.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Z.of(l.to+e.length),range:p.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=tt(t.doc,a),f;if(c==e){if(rn(t,a))return{changes:{insert:e+e,from:a},effects:Z.of(a+e.length),range:p.cursor(a+e.length)};if(bi(t,a)){let u=n&&t.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+u.length,insert:u},range:p.cursor(a+u.length)}}}else{if(n&&t.sliceDoc(a-2*e.length,a)==e+e&&(f=sn(t,a-2*e.length,o))>-1&&rn(t,f))return{changes:{insert:e+e+e+e,from:a},effects:Z.of(a+e.length),range:p.cursor(a+e.length)};if(t.charCategorizer(a)(c)!=w.Word&&sn(t,a,o)>-1&&!ws(t,a,e,o))return{changes:{insert:e+e,from:a},effects:Z.of(a+e.length),range:p.cursor(a+e.length)}}return{range:r=l}});return r?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function rn(t,e){let n=de(t).resolveInner(e+1);return n.parent&&n.from==e}function ws(t,e,n,i){let o=de(t).resolveInner(e,-1),r=i.reduce((s,l)=>Math.max(s,l.length),0);for(let s=0;s<5;s++){let l=t.sliceDoc(o.from,Math.min(o.to,o.from+n.length+r)),a=l.indexOf(n);if(!a||a>-1&&i.indexOf(l.slice(0,a))>-1){let f=o.firstChild;for(;f&&f.from==o.from&&f.to-f.from>n.length+a;){if(t.sliceDoc(f.to-n.length,f.to)==n)return!1;f=f.firstChild}return!0}let c=o.to==e&&o.parent;if(!c)break;o=c}return!1}function sn(t,e,n){let i=t.charCategorizer(e);if(i(t.sliceDoc(e-1,e))!=w.Word)return e;for(let o of n){let r=e-o.length;if(t.sliceDoc(r,e)==o&&i(t.sliceDoc(r-1,r))!=w.Word)return r}return-1}function Ds(t={}){return[gs,E,A.of(t),ms,Es,ys]}const Si=[{key:"Ctrl-Space",run:cs},{key:"Escape",run:fs},{key:"ArrowDown",run:Pe(!0)},{key:"ArrowUp",run:Pe(!1)},{key:"PageDown",run:Pe(!0,"page")},{key:"PageUp",run:Pe(!1,"page")},{key:"Enter",run:as}],Es=wt.highest(_e.computeN([A],t=>t.facet(A).defaultKeymap?[Si]:[]));class Ts{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class X{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let o=e,r=i.facet(Me).markerFilter;r&&(o=r(o,i));let s=k.set(o.map(l=>l.from==l.to||l.from==l.to-1&&i.doc.lineAt(l.from).to==l.from?k.widget({widget:new Us(l),diagnostic:l}).range(l.from):k.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new X(s,n,fe(s))}}function fe(t,e=null,n=0){let i=null;return t.between(n,1e9,(o,r,{spec:s})=>{if(!(e&&s.diagnostic!=e))return i=new Ts(o,r,s.diagnostic),!1}),i}function Is(t,e){let n=e.pos,i=e.end||n,o=t.state.facet(Me).hideOn(t,n,i);if(o!=null)return o;let r=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(s=>s.is(ki))||t.changes.touchesRange(r.from,Math.max(r.to,i)))}function Os(t,e){return t.field(O,!1)?e:e.concat(M.appendConfig.of(zs))}const ki=M.define(),Ut=M.define(),Ci=M.define(),O=ue.define({create(){return new X(k.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),i=null,o=t.panel;if(t.selected){let r=e.changes.mapPos(t.selected.from,1);i=fe(n,t.selected.diagnostic,r)||fe(n,null,r)}!n.size&&o&&e.state.facet(Me).autoPanel&&(o=null),t=new X(n,o,i)}for(let n of e.effects)if(n.is(ki)){let i=e.state.facet(Me).autoPanel?n.value.length?Le.open:null:t.panel;t=X.init(n.value,i,e.state)}else n.is(Ut)?t=new X(t.diagnostics,n.value?Le.open:null,t.selected):n.is(Ci)&&(t=new X(t.diagnostics,t.panel,n.value));return t},provide:t=>[Dt.from(t,e=>e.panel),y.decorations.from(t,e=>e.diagnostics)]}),Rs=k.mark({class:"cm-lintRange cm-lintRange-active"});function Ps(t,e,n){let{diagnostics:i}=t.state.field(O),o=[],r=2e8,s=0;i.between(e-(n<0?1:0),e+(n>0?1:0),(a,c,{spec:f})=>{e>=a&&e<=c&&(a==c||(e>a||n>0)&&(e<c||n<0))&&(o.push(f.diagnostic),r=Math.min(a,r),s=Math.max(c,s))});let l=t.state.facet(Me).tooltipFilter;return l&&(o=l(o,t.state)),o.length?{pos:r,end:s,above:t.state.doc.lineAt(r).to<s,create(){return{dom:Ws(t,o)}}}:null}function Ws(t,e){return x("ul",{class:"cm-tooltip-lint"},e.map(n=>Ai(t,n,!1)))}const Fs=t=>{let e=t.state.field(O,!1);(!e||!e.panel)&&t.dispatch({effects:Os(t.state,[Ut.of(!0)])});let n=Se(t,Le.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},ln=t=>{let e=t.state.field(O,!1);return!e||!e.panel?!1:(t.dispatch({effects:Ut.of(!1)}),!0)},Ns=t=>{let e=t.state.field(O,!1);if(!e)return!1;let n=t.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},$s=[{key:"Mod-Shift-m",run:Fs,preventDefault:!0},{key:"F8",run:Ns}],Me=he.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},Be(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n}))}});function vi(t){let e=[];if(t)e:for(let{name:n}of t){for(let i=0;i<n.length;i++){let o=n[i];if(/[a-zA-Z]/.test(o)&&!e.some(r=>r.toLowerCase()==o.toLowerCase())){e.push(o);continue e}}e.push("")}return e}function Ai(t,e,n){var i;let o=n?vi(e.actions):[];return x("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},x("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((r,s)=>{let l=!1,a=u=>{if(u.preventDefault(),l)return;l=!0;let d=fe(t.state.field(O).diagnostics,e);d&&r.apply(t,d.from,d.to)},{name:c}=r,f=o[s]?c.indexOf(o[s]):-1,h=f<0?c:[c.slice(0,f),x("u",c.slice(f,f+1)),c.slice(f+1)];return x("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${f<0?"":` (access key "${o[s]})"`}.`},h)}),e.source&&x("div",{class:"cm-diagnosticSource"},e.source))}class Us extends Vi{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return x("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class an{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Ai(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Le{constructor(e){this.view=e,this.items=[];let n=o=>{if(o.keyCode==27)ln(this.view),this.view.focus();else if(o.keyCode==38||o.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(o.keyCode==40||o.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(o.keyCode==36)this.moveSelection(0);else if(o.keyCode==35)this.moveSelection(this.items.length-1);else if(o.keyCode==13)this.view.focus();else if(o.keyCode>=65&&o.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],s=vi(r.actions);for(let l=0;l<s.length;l++)if(s[l].toUpperCase().charCodeAt(0)==o.keyCode){let a=fe(this.view.state.field(O).diagnostics,r);a&&r.actions[l].apply(e,a.from,a.to)}}else return;o.preventDefault()},i=o=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(o.target)&&this.moveSelection(r)};this.list=x("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=x("div",{class:"cm-panel-lint"},this.list,x("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>ln(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(O).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(O),i=0,o=!1,r=null;for(e.between(0,this.view.state.doc.length,(s,l,{spec:a})=>{let c=-1,f;for(let h=i;h<this.items.length;h++)if(this.items[h].diagnostic==a.diagnostic){c=h;break}c<0?(f=new an(this.view,a.diagnostic),this.items.splice(i,0,f),o=!0):(f=this.items[c],c>i&&(this.items.splice(i,c-i),o=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),r=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)o=!0,this.items.pop();this.items.length==0&&(this.items.push(new an(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),o=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:l})=>{let a=l.height/this.list.offsetHeight;s.top<l.top?this.list.scrollTop-=(l.top-s.top)/a:s.bottom>l.bottom&&(this.list.scrollTop+=(s.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),o&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(O),i=fe(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Ci.of(i)})}static open(e){return new Le(e)}}function Hs(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function We(t){return Hs(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const qs=y.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:We("#d11")},".cm-lintRange-warning":{backgroundImage:We("orange")},".cm-lintRange-info":{backgroundImage:We("#999")},".cm-lintRange-hint":{backgroundImage:We("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),zs=[O,y.decorations.compute([O],t=>{let{selected:e,panel:n}=t.field(O);return!e||!n||e.from==e.to?k.none:k.set([Rs.range(e.from,e.to)])}),zi(Ps,{hideOn:Is}),qs];var cn=function(e){e===void 0&&(e={});var{crosshairCursor:n=!1}=e,i=[];e.closeBracketsKeymap!==!1&&(i=i.concat(Cs)),e.defaultKeymap!==!1&&(i=i.concat(ei)),e.searchKeymap!==!1&&(i=i.concat(Ur)),e.historyKeymap!==!1&&(i=i.concat(Bn)),e.foldKeymap!==!1&&(i=i.concat(Ki)),e.completionKeymap!==!1&&(i=i.concat(Si)),e.lintKeymap!==!1&&(i=i.concat($s));var o=[];return e.lineNumbers!==!1&&o.push(ji()),e.highlightActiveLineGutter!==!1&&o.push(Gi()),e.highlightSpecialChars!==!1&&o.push(yn()),e.history!==!1&&o.push(vn()),e.foldGutter!==!1&&o.push(Ji()),e.drawSelection!==!1&&o.push(xn()),e.dropCursor!==!1&&o.push(Qi()),e.allowMultipleSelections!==!1&&o.push(ke.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&o.push(_i()),e.syntaxHighlighting!==!1&&o.push(Et(bn,{fallback:!0})),e.bracketMatching!==!1&&o.push(Yi()),e.closeBrackets!==!1&&o.push(xs()),e.autocompletion!==!1&&o.push(Ds()),e.rectangularSelection!==!1&&o.push(Xi()),n!==!1&&o.push(Zi()),e.highlightActiveLine!==!1&&o.push(eo()),e.highlightSelectionMatches!==!1&&o.push(kr()),e.tabSize&&typeof e.tabSize=="number"&&o.push(mn.of(" ".repeat(e.tabSize))),o.concat([_e.of(i.flat())]).filter(Boolean)},tl=function(e){e===void 0&&(e={});var n=[];e.defaultKeymap!==!1&&(n=n.concat(ei)),e.historyKeymap!==!1&&(n=n.concat(Bn));var i=[];return e.highlightSpecialChars!==!1&&i.push(yn()),e.history!==!1&&i.push(vn()),e.drawSelection!==!1&&i.push(xn()),e.syntaxHighlighting!==!1&&i.push(Et(bn,{fallback:!0})),i.concat([_e.of(n.flat())]).filter(Boolean)};const Mi="#e5c07b",St="#e06c75",Li="#56b6c2",Bi="#ffffff",be="#abb2bf",Je="#7d8799",wi="#61afef",Di="#98c379",kt="#d19a66",Ei="#c678dd",Ti="#21252b",Ct="#2c313a",vt="#282c34",Fe="#353a42",Ii="#3E4451",At="#528bff",nl={chalky:Mi,coral:St,cyan:Li,invalid:Bi,ivory:be,stone:Je,malibu:wi,sage:Di,whiskey:kt,violet:Ei,darkBackground:Ti,highlightBackground:Ct,background:vt,tooltipBackground:Fe,selection:Ii,cursor:At},Vs=y.theme({"&":{color:be,backgroundColor:vt},".cm-content":{caretColor:At},".cm-cursor, .cm-dropCursor":{borderLeftColor:At},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Ii},".cm-panels":{backgroundColor:Ti,color:be},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:vt,color:Je,border:"none"},".cm-activeLineGutter":{backgroundColor:Ct},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Fe},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Fe,borderBottomColor:Fe},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Ct,color:be}}},{dark:!0}),Ks=to.define([{tag:m.keyword,color:Ei},{tag:[m.name,m.deleted,m.character,m.propertyName,m.macroName],color:St},{tag:[m.function(m.variableName),m.labelName],color:wi},{tag:[m.color,m.constant(m.name),m.standard(m.name)],color:kt},{tag:[m.definition(m.name),m.separator],color:be},{tag:[m.typeName,m.className,m.number,m.changed,m.annotation,m.modifier,m.self,m.namespace],color:Mi},{tag:[m.operator,m.operatorKeyword,m.url,m.escape,m.regexp,m.link,m.special(m.string)],color:Li},{tag:[m.meta,m.comment],color:Je},{tag:m.strong,fontWeight:"bold"},{tag:m.emphasis,fontStyle:"italic"},{tag:m.strikethrough,textDecoration:"line-through"},{tag:m.link,color:Je,textDecoration:"underline"},{tag:m.heading,fontWeight:"bold",color:St},{tag:[m.atom,m.bool,m.special(m.variableName)],color:kt},{tag:[m.processingInstruction,m.string,m.inserted],color:Di},{tag:m.invalid,color:Bi}]),js=[Vs,Et(Ks)];var Gs=y.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),Js=function(e){e===void 0&&(e={});var{indentWithTab:n=!0,editable:i=!0,readOnly:o=!1,theme:r="light",placeholder:s="",basicSetup:l=!0}=e,a=[];switch(n&&a.unshift(_e.of([pr])),l&&(typeof l=="boolean"?a.unshift(cn()):a.unshift(cn(l))),s&&a.unshift(no(s)),r){case"light":a.push(Gs);break;case"dark":a.push(js);break;case"none":break;default:a.push(r);break}return i===!1&&a.push(y.editable.of(!1)),o&&a.push(ke.readOnly.of(!0)),[...a]},Qs=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)}),fn=Qe.define(),_s=[];function Ys(t){var{value:e,selection:n,onChange:i,onStatistics:o,onCreateEditor:r,onUpdate:s,extensions:l=_s,autoFocus:a,theme:c="light",height:f=null,minHeight:h=null,maxHeight:u=null,width:d=null,minWidth:g=null,maxWidth:S=null,placeholder:R="",editable:q=!0,readOnly:b=!1,indentWithTab:$=!0,basicSetup:D=!0,root:C,initialState:z}=t,[V,Ee]=P.useState(),[v,G]=P.useState(),[te,ne]=P.useState(),nt=y.theme({"&":{height:f,minHeight:h,maxHeight:u,width:d,minWidth:g,maxWidth:S},"& .cm-scroller":{height:"100% !important"}}),it=y.updateListener.of(U=>{if(U.docChanged&&typeof i=="function"&&!U.transactions.some(Ri=>Ri.annotation(fn))){var ye=U.state.doc,Te=ye.toString();i(Te,U)}o&&o(Qs(U))}),Oi=Js({theme:c,editable:q,readOnly:b,placeholder:R,indentWithTab:$,basicSetup:D}),ge=[it,nt,...Oi];return s&&typeof s=="function"&&ge.push(y.updateListener.of(s)),ge=ge.concat(l),P.useEffect(()=>{if(V&&!te){var U={doc:e,selection:n,extensions:ge},ye=z?ke.fromJSON(z.json,U,z.fields):ke.create(U);if(ne(ye),!v){var Te=new y({state:ye,parent:V,root:C});G(Te),r&&r(Te,ye)}}return()=>{v&&(ne(void 0),G(void 0))}},[V,te]),P.useEffect(()=>Ee(t.container),[t.container]),P.useEffect(()=>()=>{v&&(v.destroy(),G(void 0))},[v]),P.useEffect(()=>{a&&v&&v.focus()},[a,v]),P.useEffect(()=>{v&&v.dispatch({effects:M.reconfigure.of(ge)})},[c,l,f,h,u,d,g,S,R,q,b,$,D,i,s]),P.useEffect(()=>{if(e!==void 0){var U=v?v.state.doc.toString():"";v&&e!==U&&v.dispatch({changes:{from:0,to:U.length,insert:e||""},annotations:[fn.of(!0)]})}},[e,v]),{state:te,setState:ne,view:v,setView:G,container:V,setContainer:Ee}}var Xs=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Zs=P.forwardRef((t,e)=>{var{className:n,value:i="",selection:o,extensions:r=[],onChange:s,onStatistics:l,onCreateEditor:a,onUpdate:c,autoFocus:f,theme:h="light",height:u,minHeight:d,maxHeight:g,width:S,minWidth:R,maxWidth:q,basicSetup:b,placeholder:$,indentWithTab:D,editable:C,readOnly:z,root:V,initialState:Ee}=t,v=ro(t,Xs),G=P.useRef(null),{state:te,view:ne,container:nt}=Ys({container:G.current,root:V,value:i,autoFocus:f,theme:h,height:u,minHeight:d,maxHeight:g,width:S,minWidth:R,maxWidth:q,basicSetup:b,placeholder:$,indentWithTab:D,editable:C,readOnly:z,selection:o,onChange:s,onStatistics:l,onCreateEditor:a,onUpdate:c,extensions:r,initialState:Ee});if(P.useImperativeHandle(e,()=>({editor:G.current,state:te,view:ne}),[G,nt,te,ne]),typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var it=typeof h=="string"?"cm-theme-"+h:"cm-theme";return io.jsx("div",oo({ref:G,className:""+it+(n?" "+n:"")},v))});Zs.displayName="CodeMirror";export{Qe as Annotation,rl as AnnotationType,sl as BidiSpan,ll as BlockInfo,al as BlockType,Wi as ChangeDesc,Pi as ChangeSet,w as CharCategory,cl as Compartment,k as Decoration,pn as Direction,p as EditorSelection,ke as EditorState,y as EditorView,he as Facet,fl as GutterMarker,hl as Line,Ui as MapMode,ul as MatchDecorator,wt as Prec,dl as Range,qi as RangeSet,Fi as RangeSetBuilder,Hi as RangeValue,ml as RectangleMarker,pl as SelectionRange,M as StateEffect,gl as StateEffectType,ue as StateField,dn as Text,ot as Transaction,Lt as ViewPlugin,yl as ViewUpdate,Vi as WidgetType,xl as __test,cn as basicSetup,bl as closeHoverTooltips,W as codePointAt,J as codePointSize,nl as color,Be as combineConfig,Mt as countColumn,Zi as crosshairCursor,Zs as default,Gs as defaultLightThemeOption,xn as drawSelection,Qi as dropCursor,ee as findClusterBreak,Sl as findColumn,Bt as fromCodePoint,Js as getDefaultExtensions,kl as getDrawSelectionConfig,Se as getPanel,Qs as getStatistics,gn as getTooltip,Cl as gutter,vl as gutterLineClass,Al as gutters,Ml as hasHoverTooltips,eo as highlightActiveLine,Gi as highlightActiveLineGutter,yn as highlightSpecialChars,Ll as highlightTrailingWhitespace,Bl as highlightWhitespace,zi as hoverTooltip,_e as keymap,wl as layer,Dl as lineNumberMarkers,ji as lineNumbers,ut as logException,tl as minimalSetup,js as oneDark,Ks as oneDarkHighlightStyle,Vs as oneDarkTheme,El as panels,no as placeholder,Xi as rectangularSelection,Tl as repositionTooltips,Ni as runScopeHandlers,Il as scrollPastEnd,Dt as showPanel,$i as showTooltip,Ol as tooltips,Ys as useCodeMirror};
